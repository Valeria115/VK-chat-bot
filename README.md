# Бот VK Education

## Введение
Бот VK Education — это чат-бот на Python, разработанный для помощи пользователям с вопросами о проектах VK Education. Он интегрируется с VK API для обмена сообщениями, использует GigaChat для генерации интеллектуальных ответов и поддерживает локальную базу знаний о образовательных проектах, полученную с сайта VK Education. Бот включает функции коррекции орфографии, фильтрации нецензурной лексики и контекстуальные ответы, адаптированные к образовательным запросам.

## Особенности
- **Ответы на вопросы**: Отвечает на запросы пользователей о проектах VK Education с помощью GigaChat.
- **Коррекция орфографии**: Автоматически исправляет орфографические ошибки в сообщениях пользователей с помощью библиотеки `autocorrect`.
- **Фильтрация нецензурной лексики**: Обнаруживает и блокирует неуместные выражения с помощью предварительно обученной модели BERT.
- **Контекстуальные ответы**: Определяет, относится ли вопрос к VK Education, и предоставляет соответствующий контекст из базы знаний.
- **Список проектов**: Перечисляет образовательные проекты, адаптированные для конкретных аудиторий (например, студенты, школьники).
- **Обновление базы знаний**: Периодически обновляет базу данных с помощью данных, полученных с сайта VK Education.
- **Ссылки для помощи**: Добавляет соответствующие ссылки к ответам для получения дополнительной информации.

## Установка
1. **Предварительные требования**:
   - Python 3.8+
   - Git (необязательно, для клонирования репозитория)

2. **Клонирование репозитория** (если применимо):
   ```bash
   git clone <url-репозитория>
   cd <директория-репозитория>
   ```

3. **Установка зависимостей**:
   Установите необходимые библиотеки Python с помощью pip:
   ```bash
   pip install -r requirements.txt
   ```
   Требуемые библиотеки:
   - `vk_api`
   - `sentence_transformers`
   - `playwright`
   - `gigachat`
   - `autocorrect`
   - `transformers`
   - `beautifulsoup4`
   - `numpy`
   - `torch`
   - `python-dotenv`

4. **Установка браузеров Playwright**:
   ```bash
   playwright install
   ```

## Конфигурация
1. **Создание файла `.env`**:
   В корне проекта создайте файл `.env` со следующими переменными:
   ```
   CONFIRMATION_TOKEN=<ваш_токен_подтверждения>
   ACCESS_TOKEN=<ваш_токен_доступа>
   WEBHOOK_URL=<ваш_url_вебхука>
   VK_API_TOKEN=<ваш_токен_vk_api>
   VK_GROUP_ID=<id_вашей_группы_vk>
   GIGACHAT_AUTH_KEY=<ваш_ключ_авторизации_gigachat>
   ```
   - `VK_API_TOKEN`: Токен для доступа к VK API.
   - `VK_GROUP_ID`: ID группы VK, в которой работает бот.
   - `GIGACHAT_AUTH_KEY`: Ключ авторизации для API GigaChat.
   - Остальные токены необязательны в зависимости от вашей настройки VK.

2. **Настройка базы данных**:
   Бот автоматически инициализирует базу данных SQLite (`knowledge.db`) при первом запуске. Ручная настройка не требуется.

## Использование
1. **Запуск бота**:
   Запустите основной скрипт:
   ```bash
   python app.py
   ```
   Бот инициализируется, подключится к VK и начнет прослушивать сообщения.

2. **Взаимодействие с ботом**:
   - Отправьте сообщение боту через VK (например, в чате группы).
   - Используйте `/start` или "начать" для получения приветственного сообщения.
   - Задавайте вопросы о проектах VK Education (например, "Какие курсы есть для студентов?").

3. **Примеры взаимодействия**:
   - **Пользователь**: "Какие проекты для школьников?"  
     **Бот**: Перечисляет соответствующие проекты с краткими описаниями и ссылками.
   - **Пользователь**: "Можно ли участвовать в двух проектах?"  
     **Бот**: "Да, если нет конфликтов по времени и требованиям."

## Обзор модулей
- **`config.py`**:
  - Управляет переменными окружения и константами (например, токены API, путь к базе данных).
- **`app.py`**:
  - Основная логика бота: обрабатывает взаимодействия с VK API, обработку сообщений и генерацию ответов.
- **`db.py`**:
  - Управляет базой данных SQLite, веб-скрапингом и извлечением знаний с использованием векторных представлений предложений.
- **`ai_gigachat.py`**:
  - Интерфейс с API GigaChat для генерации ответов на основе вопросов пользователей и контекста.
- **`text_utils.py`**:
  - Предоставляет утилиты для обработки текста: коррекция орфографии и обнаружение нецензурной лексики.

## Устранение неполадок
- **Бот не отвечает**:
  - Проверьте токен VK API и ID группы в `.env`.
  - Убедитесь в наличии интернет-соединения для API VK и GigaChat.
- **Ошибки базы данных**:
  - Проверьте права на запись для `knowledge.db`.
  - Запустите `python db.py` отдельно для отладки инициализации.
- **Ошибки GigaChat persistently**:
  - Проверьте, что `GIG meat_AUTH_KEY` действителен.
- **Логи**:
  - Проверьте вывод в консоли для подробных логов (по умолчанию установлено на уровень `INFO`).
